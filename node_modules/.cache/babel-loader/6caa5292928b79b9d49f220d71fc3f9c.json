{"remainingRequest":"F:\\桌面\\jingdong\\node_modules\\babel-loader\\lib\\index.js!F:\\桌面\\jingdong\\node_modules\\eslint-loader\\index.js??ref--13-0!F:\\桌面\\jingdong\\src\\effects\\cartEffects.js","dependencies":[{"path":"F:\\桌面\\jingdong\\src\\effects\\cartEffects.js","mtime":1622201742904},{"path":"F:\\桌面\\jingdong\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"F:\\桌面\\jingdong\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000},{"path":"F:\\桌面\\jingdong\\node_modules\\eslint-loader\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMubnVtYmVyLnRvLWZpeGVkLmpzIjsKLy8g5o6l5Y+j6L+U5Zue5pWw5o2u57uT5p6ECi8vIHsgICAgCi8vICAgICBzaG9wSWQ6eyAgICAgICAgICAgICAgICAgICAvL+WVhumTumlkCi8vICAgICAgIHNob3BuYW1lOiAn5rKD5bCU546bJywgICAgICAvL+WVhumTuuWQjeensAovLyAgICAgICBwcm9kdWN0TGlzdDp7ICAgICAgICAgICAvL+WVhuWTgeWIl+ihqAovLyAgICAgICAgIHByb2R1Y3RJZDp7ICAgICAgICAgICAvL+WVhuWTgWlkCi8vICAgICAgICAgICBfaWQ6ICIxIiwKLy8gICAgICAgICAgIGltZ1VybDogImh0dHA6Ly93d3cuZGVsbC1sZWUuY29tL2ltZ3MvdnVlMy90b21hdG8ucG5nIiwKLy8gICAgICAgICAgIG5hbWU6ICLnlarojIQgMjUwZyAvIOS7vSIsCi8vICAgICAgICAgICBvbGRQcmljZTogMzkuNiwgICAgICAvL+WVhuWTgeWOn+S7twovLyAgICAgICAgICAgcHJpY2U6IDMzLjYsICAgICAgICAgLy/llYblk4Hku7fmoLwKLy8gICAgICAgICAgIHNhbGVzOiAxMCwgICAgICAgICAgIC8v5ZWG5ZOB5pyI5ZSu5pWw6YePCi8vICAgICAgICAgICBjb3VudDogMiwgICAgICAgICAgICAvL+WVhuWTgeaVsOmHjwovLyAgICAgICAgICAgY2hlY2vvvJp0cnVlICAgICAgICAgIC8v6LSt54mp6L2m54q25oCBCi8vICAgICAgICAgfQovLyAgICAgICB9Ci8vICAgICB9Ci8vIH0KaW1wb3J0IHsgY29tcHV0ZWQgfSBmcm9tICd2dWUnOwppbXBvcnQgeyB1c2VTdG9yZSB9IGZyb20gJ3Z1ZXgnOyAvLyDotK3nianovabnm7jlhbPpgLvovpEKCmV4cG9ydCB2YXIgdXNlQ29tbW9uQ2FydEVmZmVjdCA9IGZ1bmN0aW9uIHVzZUNvbW1vbkNhcnRFZmZlY3Qoc2hvcElkKSB7CiAgdmFyIHN0b3JlID0gdXNlU3RvcmUoKTsKICB2YXIgY2FydExpc3QgPSBzdG9yZS5zdGF0ZS5jYXJ0TGlzdDsgLy8gLy9wcm94eeaLpuaIquihjOS4ugogIC8vIGxldCBfaGFuZGxlciA9ewogIC8vICAgICBnZXQ6ZnVuY3Rpb24oIHRhcmdldCwgX3AgKXsKICAvLyAgICAgICAgIHJldHVybiB0YXJnZXQKICAvLyAgICAgfQogIC8vIH0KICAvLyAvL+WIm+W7unByb3h55a+56LGhCiAgLy8gbGV0IF9wcm94eSA9IG5ldyBQcm94eSAoIGNhcnRMaXN0LCBfaGFuZGxlcikKICAvLyAvLyBsZXQgdGFyZ2V0ID0gY2FydExpc3Q7CiAgLy8gbGV0IHAgPSBuZXcgUHJveHkodGFyZ2V0LCB7fSk7CiAgLy8gY29uc29sZS5sb2cocC5zaG9wSWQsJ3AnKQoKICB2YXIgY2hhbmdlQ2FydEl0ZW1JbmZvID0gZnVuY3Rpb24gY2hhbmdlQ2FydEl0ZW1JbmZvKHNob3BJZCwgcHJvZHVjdElkLCBwcm9kdWN0SW5mbywgbnVtKSB7CiAgICBzdG9yZS5jb21taXQoJ2NoYW5nZUNhcnRJdGVtSW5mbycsIHsKICAgICAgc2hvcElkOiBzaG9wSWQsCiAgICAgIHByb2R1Y3RJZDogcHJvZHVjdElkLAogICAgICBwcm9kdWN0SW5mbzogcHJvZHVjdEluZm8sCiAgICAgIG51bTogbnVtCiAgICB9KTsKICB9OyAvLyDojrflj5bllYblk4HliJfooagKCgogIHZhciBwcm9kdWN0TGlzdCA9IGNvbXB1dGVkKGZ1bmN0aW9uICgpIHsKICAgIHZhciBfY2FydExpc3Qkc2hvcElkOwoKICAgIHZhciBwcm9kdWN0TGlzdCA9ICgoX2NhcnRMaXN0JHNob3BJZCA9IGNhcnRMaXN0W3Nob3BJZF0pID09PSBudWxsIHx8IF9jYXJ0TGlzdCRzaG9wSWQgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9jYXJ0TGlzdCRzaG9wSWQucHJvZHVjdExpc3QpIHx8IHt9OwogICAgdmFyIG5vdEVtcHR5cHJvZHVjdExpc3QgPSB7fTsKCiAgICBmb3IgKHZhciBpIGluIHByb2R1Y3RMaXN0KSB7CiAgICAgIHZhciBwcm9kdWN0ID0gcHJvZHVjdExpc3RbaV07CgogICAgICBpZiAocHJvZHVjdC5jb3VudCA+IDApIHsKICAgICAgICBub3RFbXB0eXByb2R1Y3RMaXN0W2ldID0gcHJvZHVjdDsKICAgICAgfQogICAgfQoKICAgIHJldHVybiBub3RFbXB0eXByb2R1Y3RMaXN0OwogIH0pOyAvLyDojrflj5bllYbpk7rlkI3np7AKCiAgdmFyIHNob3BOYW1lID0gY29tcHV0ZWQoZnVuY3Rpb24gKCkgewogICAgdmFyIF9jYXJ0TGlzdCRzaG9wSWQyOwoKICAgIHZhciBzaG9wTmFtZSA9ICgoX2NhcnRMaXN0JHNob3BJZDIgPSBjYXJ0TGlzdFtzaG9wSWRdKSA9PT0gbnVsbCB8fCBfY2FydExpc3Qkc2hvcElkMiA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2NhcnRMaXN0JHNob3BJZDIucHJvZHVjdExpc3Quc2hvcE5hbWUpIHx8ICcnOyAvLyBjb25zb2xlLmxvZyhzaG9wTmFtZSwnc2hvcE5hbWUnKQogICAgLy8gY29uc29sZS5sb2cocCwncCcpCiAgICAvLyBjb25zb2xlLmxvZyhjYXJ0TGlzdFtzaG9wSWRdLCdjYXJ0TGlzdFtzaG9wSWRdJykKICAgIC8vIGNvbnNvbGUubG9nKGNhcnRMaXN0W3Nob3BJZF0ucHJvZHVjdExpc3QsJ2NhcnRMaXN0W3Nob3BJZF0ucHJvZHVjdExpc3QnKQoKICAgIHJldHVybiBzaG9wTmFtZTsKICB9KTsKICB2YXIgY2FsY3VsYXRpb25zID0gY29tcHV0ZWQoZnVuY3Rpb24gKCkgewogICAgdmFyIF9jYXJ0TGlzdCRzaG9wSWQzOwoKICAgIHZhciBwcm9kdWN0TGlzdCA9IChfY2FydExpc3Qkc2hvcElkMyA9IGNhcnRMaXN0W3Nob3BJZF0pID09PSBudWxsIHx8IF9jYXJ0TGlzdCRzaG9wSWQzID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfY2FydExpc3Qkc2hvcElkMy5wcm9kdWN0TGlzdDsKICAgIGNvbnNvbGUubG9nKHByb2R1Y3RMaXN0LCAncHJvZHVjdExpc3Q4ODg4OCcpOwogICAgY29uc29sZS5sb2coY2FydExpc3QsICdjYXJ0TGlzdCcpOwogICAgdmFyIHJlc3VsdCA9IHsKICAgICAgdG90YWw6IDAsCiAgICAgIC8v5ZWG5ZOB5pWw6YePCiAgICAgIHByaWNlOiAwLAogICAgICAvL+WVhuWTgeaAu+mHkeminQogICAgICBhbGxDaGVja2VkOiB0cnVlIC8v5YWo6YCJ5oyJ6ZKu5YiH5o2iaWNvbuWbvuaghwoKICAgIH07CiAgICBjb25zb2xlLmxvZyhwcm9kdWN0TGlzdCk7CgogICAgaWYgKHByb2R1Y3RMaXN0KSB7CiAgICAgIGZvciAodmFyIGkgaW4gcHJvZHVjdExpc3QpIHsKICAgICAgICB2YXIgcHJvZHVjdCA9IHByb2R1Y3RMaXN0W2ldOyAvLyDorqHnrpfliqDlhaXotK3nianovabnmoTllYblk4HmlbDph48KCiAgICAgICAgcmVzdWx0LnRvdGFsICs9IHByb2R1Y3QuY291bnQ7CgogICAgICAgIGlmIChwcm9kdWN0LmNoZWNrKSB7CiAgICAgICAgICAvLyDorqHnrpfliqDlhaXotK3nianovabllYblk4HmgLvph5Hpop0KICAgICAgICAgIHJlc3VsdC5wcmljZSArPSBwcm9kdWN0LmNvdW50ICogcHJvZHVjdC5wcmljZTsKICAgICAgICB9CgogICAgICAgIGlmIChwcm9kdWN0LmNvdW50ID4gMCAmJiAhcHJvZHVjdC5jaGVjaykgewogICAgICAgICAgLy8g5YWo6YCJ5oyJ6ZKu5YiH5o2iaWNvbuWbvuaghwogICAgICAgICAgcmVzdWx0LmFsbENoZWNrZWQgPSBmYWxzZTsKICAgICAgICB9CiAgICAgIH0KICAgIH0gLy8g5Yqg5YWl6LSt54mp6L2m5ZWG5ZOB5oC76YeR6aKd5L+d55WZ5Lik5L2N5bCP5pWwCgoKICAgIHJlc3VsdC5wcmljZSA9IHJlc3VsdC5wcmljZS50b0ZpeGVkKDIpOwogICAgcmV0dXJuIHJlc3VsdDsKICB9KTsKICByZXR1cm4gewogICAgY2FydExpc3Q6IGNhcnRMaXN0LAogICAgcHJvZHVjdExpc3Q6IHByb2R1Y3RMaXN0LAogICAgY2FsY3VsYXRpb25zOiBjYWxjdWxhdGlvbnMsCiAgICBzaG9wTmFtZTogc2hvcE5hbWUsCiAgICBjaGFuZ2VDYXJ0SXRlbUluZm86IGNoYW5nZUNhcnRJdGVtSW5mbwogIH07Cn07"},{"version":3,"sources":["F:/桌面/jingdong/src/effects/cartEffects.js"],"names":["computed","useStore","useCommonCartEffect","shopId","store","cartList","state","changeCartItemInfo","productId","productInfo","num","commit","productList","notEmptyproductList","i","product","count","shopName","calculations","console","log","result","total","price","allChecked","check","toFixed"],"mappings":"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","sourcesContent":["    // 接口返回数据结构\r\n    // {    \r\n    //     shopId:{                   //商铺id\r\n    //       shopname: '沃尔玛',      //商铺名称\r\n    //       productList:{           //商品列表\r\n    //         productId:{           //商品id\r\n    //           _id: \"1\",\r\n    //           imgUrl: \"http://www.dell-lee.com/imgs/vue3/tomato.png\",\r\n    //           name: \"番茄 250g / 份\",\r\n    //           oldPrice: 39.6,      //商品原价\r\n    //           price: 33.6,         //商品价格\r\n    //           sales: 10,           //商品月售数量\r\n    //           count: 2,            //商品数量\r\n    //           check：true          //购物车状态\r\n    //         }\r\n    //       }\r\n    //     }\r\n    // }\r\nimport { computed } from 'vue';\r\nimport { useStore } from 'vuex';\r\n// 购物车相关逻辑\r\nexport const useCommonCartEffect = (shopId) => {\r\n    const store = useStore();\r\n    const cartList = store.state.cartList;\r\n    // //proxy拦截行为\r\n    // let _handler ={\r\n    //     get:function( target, _p ){\r\n    //         return target\r\n    //     }\r\n\r\n    // }\r\n    // //创建proxy对象\r\n    // let _proxy = new Proxy ( cartList, _handler)\r\n    // // let target = cartList;\r\n    // let p = new Proxy(target, {});\r\n    // console.log(p.shopId,'p')\r\n    const changeCartItemInfo = ( shopId, productId, productInfo, num ) => {\r\n        store.commit('changeCartItemInfo', { shopId, productId, productInfo, num })\r\n    };\r\n    // 获取商品列表\r\n    const productList = computed(() => {\r\n        const productList = cartList[shopId]?.productList || {};\r\n        const notEmptyproductList = {};\r\n        for( let i in productList){\r\n            const product = productList[i]\r\n            if(product.count > 0){\r\n                notEmptyproductList[i] = product\r\n            }\r\n        }\r\n        return notEmptyproductList;\r\n    });\r\n    // 获取商铺名称\r\n    const shopName = computed(() => {\r\n        const shopName = cartList[shopId]?.productList.shopName || '';\r\n        // console.log(shopName,'shopName')\r\n        // console.log(p,'p')\r\n        // console.log(cartList[shopId],'cartList[shopId]')\r\n        // console.log(cartList[shopId].productList,'cartList[shopId].productList')\r\n        return shopName;\r\n    });\r\n    const calculations = computed(() => {\r\n        const productList = cartList[shopId]?.productList;\r\n        console.log(productList,'productList88888')\r\n        console.log(cartList,'cartList')\r\n        const result = { \r\n            total: 0,           //商品数量\r\n            price: 0,           //商品总金额\r\n            allChecked: true    //全选按钮切换icon图标\r\n        };\r\n        console.log(productList)\r\n        if(productList){\r\n            for(let i in productList){\r\n                const product = productList[i]\r\n                // 计算加入购物车的商品数量\r\n                result.total += product.count\r\n                if(product.check){\r\n                    // 计算加入购物车商品总金额\r\n                    result.price += ( product.count * product.price )\r\n                }\r\n                if(product.count>0 && !product.check){\r\n                    // 全选按钮切换icon图标\r\n                    result.allChecked = false\r\n                }\r\n            }\r\n        }\r\n        // 加入购物车商品总金额保留两位小数\r\n        result.price = result.price.toFixed(2);\r\n        return result;\r\n    });\r\n    return { cartList, productList, calculations, shopName, changeCartItemInfo };\r\n}\r\n"]}]}